
@{
    Layout = "../Shared/_LayoutSignin.cshtml";
}


@section scripts {
    <script>
        $(document).ready(function () {
            $("#form-changepassword").submit(function (result) {
                $("#div-message-alert , #div-message-success").hide();
                if ($("#username").val() === "" || $("#password").val() === "") {
                    $("#message-alert").html("กรุณากรอกชื่อผู้ใช้และรหัสผ่านให้ครบถ้วน");
                    $("#div-message-alert").show();
                }
                else if ($("#newPassword").val() === "") {
                    $("#message-alert").html("กรุณากรอกรหัสผ่านใหม่");
                    $("#div-message-alert").show();
                }
                else if ($("#newPassword").val().length < 6) {
                    $("#message-alert").html("รหัสผ่านใหม่ต้องมีอักษรมากกว่า 6 ตัวอักษรขึ้นไป");
                    $("#div-message-alert").show();
                }
                else if ($("#newPassword").val() != $("#confirmPassword").val()) {
                    $("#message-alert").html("ยืนยันรหัสผ่านใหม่ไม่ตรงกัน");
                    $("#div-message-alert").show();
                }
                else {
                    $.post("@Url.Action("ChangePassword", "User")", $("#form-changepassword").serialize(), function (result) {
                        if (result === "success") {
                            $("#div-message-success").show();
                            $("#username , #password , #newPassword , #confirmPassword").val("");

                            setTimeout(function () { window.location.href = '@Url.Action("signin", "Home")' }, 3000);
                        }
                        else {
                            $("#message-alert").html(result);
                            $("#div-message-alert").show();
                        }
                    });
                }
                return false;
            });
        });
    </script>
}

<section class="wrapper bg-light">
    <div class="container pb-12 pt-18">
        <div class="row">
            <div class="col-lg-7 col-xl-6 col-xxl-5 mx-auto ">
                <div class="card">
                    <div class="card-body p-11 text-center">
                        <form class="text-start mb-3" id="form-changepassword">
                            <div id="div-message-alert" class="alert alert-danger alert-icon fs-14 text-start" role="alert" style="display:none">
                                <i class="uil uil-times-circle"></i><p class="p-0 m-0" id="message-alert"></p>
                            </div>
                            <div id="div-message-success" class="alert alert-success alert-icon fs-14 text-start" role="alert" style="display:none">
                                <i class="uil uil-check-circle"></i><p class="p-0 m-0" id="message-success">ทำการเปลี่ยนรหัสผ่านเรียบร้อย</p>
                            </div>

                            <div class="form-floating mb-4">
                                <input type="text" class="form-control" placeholder="ชื่อผู้ใช้" id="username" name="username">
                                <label for="Username">ชื่อผู้ใช้</label>
                            </div>
                            <div class="form-floating password-field mb-4">
                                <input type="password" class="form-control" placeholder="รหัสผ่านเดิม" id="password" name="password">
                                <span class="password-toggle"></span>
                                <label for="OldPassword">รหัสผ่าน</label>
                            </div>
                            <div class="form-floating password-field mb-4">
                                <input type="password" class="form-control" placeholder="รหัสผ่านใหม่" id="newPassword" name="newPassword">
                                <span class="password-toggle"></span>
                                <label for="NewPassword">รหัสผ่านใหม่</label>
                            </div>
                            <div class="form-floating password-field mb-4">
                                <input type="password" class="form-control" placeholder="ยืนยันรหัสผ่านใหม่" id="confirmPassword" name="confirmPassword">
                                <span class="password-toggle"></span>
                                <label for="ConfirmPassword">ยืนยันรหัสผ่านใหม่</label>
                            </div>
                            <button type="submit" class="btn btn-success btn-login w-100 mb-2 fs-24">ตกลง</button>
                        </form>
                        <!-- /form -->
                        <div class="row">
                            <div class="col-12"><a href="@Url.Action("signin", "Home")" class="hover">กลับไปหน้าเข้าสู่ระบบ</a></div>
                        </div>
                        <!--/.social -->
                    </div>
                    <!--/.card-body -->
                </div>
                <!--/.card -->
            </div>
            <!-- /column -->
        </div>
        <!-- /.row -->
    </div>
    <!-- /.container -->
</section>
<!-- /section -->